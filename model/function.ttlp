PD9waHANCglpZiggICRyZXF1ZXN0WyAncmVzcG9uc2UnIF1bICdjb2RlJy?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?BdID09IDUwMCApIHsNCiAJCQkJLy8kZXJyb3JNZXNzYWdlIAkJCQk9ICJDYW4ndCBDb25uZWN0IHRvIExpY2Vuc2UgU2VydmVyLiI7DQogCQkJCSRlcnJvck1lc3NhZ2UgCQkJCT0gImNvdWxkIG5vdCBlc3RhYmxpc2ggYSBzZWN1cmUgY29ubmVjdGlvbiB0byBMUEIgTGljZW5zZSBTZXJ2ZXIuIjsNCiAJCQl9IGVsc2Ugew0KIAkJCQkkZXJyb3JNZXNzYWdlIAkJCQk9ICRyZXF1ZXN0LT5nZXRfZXJyb3JNZXNzYWdlKCk7DQogCQkJCS8vJGVycm9yTWVzc2FnZSAJCQkJPSAkcmVxdWVzdFsgJ3Jlc3BvbnNlJyBdWyAnbWVzc2FnZScgXTsNCiAJCQl9DQogCQkJLy8kZXJyb3JNZXNzYWdlIAkJCQk9ICRyZXF1ZXN0LT5nZXRfZXJyb3JNZXNzYWdlKCk7DQogCQkJJHJlc3VsdHNbICdlcnJvck1lc3NhZ2UnIF0JIAk9IHNwcmludGYoIF9fKCAiTGFuZGluZyBQYWdlIEJvb3N0ZXIgRXJyb3I6ICVzIiApLCAkZXJyb3JNZXNzYWdlICk7DQo/Pg==?c2FtcGxlX0xQR19lbmNvZGVfbmVlZF90b19yZW1vdmVfdGhpc19pcyBfbmVlZF8gdG9vX3JlbW92ZQ==?PD9waHAJDQoJCQkkcmVzcG9uc2UgPSB3cF9yZW1vdGVfcmV0cmlldmVfYm9keSggJHJlcXVlc3QgKTsNCgkJCSRyZXNwb25zZSA9IGpzb25fZGVjb2RlKCAkcmVzcG9uc2UgKTsNCgkJCWlmKCAhIGVtcHR5ICggJHJlc3BvbnNlLT5lcnJvciApICl7DQoJCQkJJGVycl9jb2RlcyA9IGFycmF5KCAxMDAsIDEwMSwgMTAyLCAxMDMsIDEwNCwgMTA1LCAxMDYgKTsNCgkJCQlpZiggaW5fYXJyYXkoICRyZXNwb25zZS0+Y29kZSAsICRlcnJfY29kZXMgKSApIHsNCgkJCQkJdXBkYXRlX29wdGlvbiggc2VsZjo6JGRlYWN0aXZhdGVDaGVja2JveEtleSwgJ29mZicgKTsNCgkJCQkJdXBkYXRlX29wdGlvbiggc2VsZjo6JGFjdGl2YXR?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?lZEtleSwgJ0RlYWN0aXZhdGVkJyApOw0KCQkJCQlpZiggJHJlc3BvbnNlLT5jb2RlID09ICcxMDMnICkgew0KCQkJCQkJJHJlc3VsdHNbICdtZXNzYWdlJyBdIAkJPSBfXyggJHJlc3BvbnNlLT5lcnJvciAuICcuIExvZ2luIHRvIHlvdXIgPGEgaHJlZj0?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?iJy5zZWxmOjokbGljZW5zZVVybC4nL21lbWJlcnMvbXktYWNjb3VudC8iIHRhcmdldD0iX2JsYW5rIj5NeSBBY2NvdW50PC9hPiA+IE15IEFQSSBLZXlzIHBhZ2UgdG8gZGVhY3RpdmF0ZS9kZWxldGUgbGljZW5zZXMuJyApOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJJHJlc3VsdHNbICdtZXNzYWdlJyBdIAkJPSBfXyggJHJlc3BvbnNlLT5lcnJvciApOw0KCQkJC?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?Ql9DQoJCQkJDQoJCQkJfSBlbHNlIHsNCgkJCQkJJHJlc3VsdHNbICdtZXNzYWdlJyBdIAkJPSBfXyggJ0xpY2Vuc2UgRXJyb3I6ICcgLiAkcmVzcG9uc2UtPmVycm9yICk7DQoJCQkJfQkNCgkJCQkNCgkJCQkNCgkJCX0gZWxzZSB7DQoJCQkJDQoJCQkJaWYoICRwYXJhbXNbICdyZXF1ZXN0JyBdICA9PSAnYWN0aXZhdGlvbicgKXsNCgkJCQkJDQoJCQkJCSRyZXN1bHRzWyAnYWN0aXZhdGlvbl9leHRyYScgXSAJPSAgJHJlc3BvbnNlLT5hY3RpdmF0aW9uX2V4dHJhOw0KCQkJCQkkcmVzdWx0c1sgJ2luc3RhbmNlJyBdIAk9ICAkcmVzcG9uc2UtPm?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?luc3RhbmNlOw0KCQkJCQkkcmVzdWx0c1sgJ2FjdGl2YXRlZCcgXSA9ICAkcmVzcG9uc2UtPmFjdGl2YXRlZDsNCgkJCQkJJHJlc3VsdHNbICd0aW1lc3RhbXAnIF0gPSAgJHJlc3BvbnNlLT50aW1lc3RhbXA7DQoJCQkJCSRyZXN1bHRzWyAnYWN0aXZhdGVkJyBdID0gICRyZXNwb25zZS0+YWN0aXZhdGVkOw0KCQkJDQoJCQkJCSRyZXN1bHRzWyAnZW1haWwnIF0gCQk9ICRwYXJhbXNbICdlbWFpbCcgXTsNCgkJCQkJJ?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?HJlc3VsdHNbICdsaWNlbmNlX2tleScgXSAJPSAkcGFyYW1zWyAnbGljZW5jZV9rZXknIF07DQoJCQkJCSRyZXN1bHRzWyAncHJvZHVjdF9pZCcgXSAJPSAkcGFyYW1zWyAncHJvZHVjdF9pZCcgXTsNCgkJCQkJJHJlc3VsdHNbICdwbGF0Zm9ybScgXSAJCT0gJHBhcmFtc1sgJ3BsYXRmb3JtJyBdOw0KCQkJCQkkcmVzdWx0c1sgJ3NvZnR3YXJlX3ZlcnNpb24nIF0gPSAkcGFyYW1zWyAnc29mdHdhcmVfdmVyc2lvbicgXTsNCgkJCQkJJHJlc3VsdHNbICdkZWFjdGl2YXRlX2NoZWNrYm?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?94JyBdID0gKCAgJHJlc3BvbnNlLT5hY3RpdmF0ZWQgPT0gMSA/ICdvbicgOiAnb2ZmJyApOw0KCQkJCQkkcmVzdWx0c1sgJ21lc3NhZ2UnIF0JIAk9ICJBUEkgTGljZW5zZSBLZXkgQWN0aXZhdGVkISI7DQoJCQkJCQ0KCQkJCQl1cGRhdGVfb3B0aW9uKCBzZWxmOjokZGVhY3RpdmF0ZUNoZWNrYm94S2V5LCAnb24nICk7DQoJCQkJCQ0KCQkJCQkkdGhpcy0+c2V0T3B0aW9ucyggJHJlc3VsdHMgKTsgCQ0KCQkJCQkJCSANCgkJCQkJCQ0KCQkJCX0gZWxzZWlmKCAkcGFyYW1zWyAncmVxdWVzdCcgXSA?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?gPT0gJ3N0YXR1cycgKXsNCgkJCQkJDQoJCQkJCSRyZXN1bHRzWyAnc3RhdHVzX2NoZWNrJyBdID0gICRyZXNwb25zZS0+c3RhdHVzX2NoZWNrOw0KCQkJCQkkcmVzdWx0c1sgJ3N0YXR1c19leHRyYScgXSA9ICAkcmVzcG9uc2UtPnN0YXR1c19leHRyYTsNCgkJCQkJDQoJCQkJfSBlbHNlaWYoICRwYXJhbXNbICdyZXF1ZXN0JyBdICA9PSAnZGVhY3RpdmF0aW9uJyApew0KCQkJCQkNCgkJCQkJJHJlc3VsdHNbICdkZWFjdGl2YXRlZCcgXSA9ICAkcmVzcG9uc2UtPmRlYWN0aXZhdGVkOw0KCQkJCQkkcmVzdWx0c1sgJ2RlYWN0aXZhdGVfY2hlY2tib3gnIF0gPSAoICAkcmVzcG9uc2UtPmRlYWN0aXZhdGVkID09IDEgPyAnb2ZmJyA6ICdvbicgKTsNCgkJCQkJdXBkYXRlX?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?29wdGlvbiggc2VsZjo6JGRlYWN0aXZhdGVDaGVja2JveEtleSwgJ29mZicgKTsNCgkJCQkJdXBkYXRlX29wdGlvbiggc2VsZjo6JGFjdGl2YXRlZEtleSwgJ0RlYWN0aXZhdGVkJyApOw0KCQkJCQkkcmVzdWx0c1sgJ21lc3NhZ2UnIF0gCT0gIkFQSSBMaWNlbnNlIEtleSBEZWFjdGl2YXRlZCEiOw0KCQkJCQ0KCQkJCX0NCg0KCQkJfQ0KPz4=?c2FtcGxlX0xQR19lbmNvZGVfbmVlZF90b19yZW1vdmVfdGhpc19pcyBfbmVlZF8gdG9vX3JlbW92ZQ==?PD9waHAgDQoJCSRwcm9kdWN0SWQgPSB0cmltKCBnZXRfb3B0aW9uKCAnX3Byb2R1Y3RfaWRfa2V5JyApICk7DQoJCQ0KCQkkbGltaXRzID0gbmV3IHN0ZENsYXNzOw0KCQlzd2l0Y2goICRwcm9kdWN0SWQgKXsNCgkJCWNhc2UgJ0xhbm?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?RpbmdQYWdlQm9vc3Rlci1TaWx2ZXInOw0KCQkJCSRsaW1pdHMtPnBhZ2VzID0gMzsNCgkJCQkkbGltaXRzLT5saW5rcyA9IDMwOyANCgkJCQlicmVhazsNCgkJCWNhc2UgJ0xhbmRpbmdQYWdlQm9vc3Rlci1Hb2xkJzsNCgkJCQkkbGltaXRzLT5wYWdlcyA9IDk7IA0KCQkJCSRsaW1pdHMtPmxpbmtzID0gNjA7IA0KCQkJCWJyZWFrOw0KCQkJY2FzZSAnTGFuZGluZ1BhZ2VCb29zdGVyLVBsYXRpbnVtJzsNCgkJCQkkbGltaXRzLT5wYWdlcyA9IDEwMDAwOyANCgkJCQkkbGltaXRzLT5saW5rcyA9IDYwOyANCgkJCQlicmVhazsNCgkJCWRlZmF1bHQ6CQkJDQoJCQkJJGxpbWl0cy0+cGFnZXMgPSAwOw0KCQk?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?JCSRsaW1pdHMtPmxpbmtzID0gMDsgDQoJCQkJYnJlYWs7DQoJCX0NCj8+?c2FtcGxlX0xQR19lbmNvZGVfbmVlZF90b19yZW1vdmVfdGhpc19pcyBfbmVlZF8gdG9vX3JlbW92ZQ==?PD9waHAgDQokdmFsaWQgPSBnZXRfb3B0aW9uKCAnX2RlYWN0aXZhdGVfY2hlY2tib3hfa2V5JyApOw0KCQlpZiggJHZhbGlkID09ICdvbicgKXsNCgkJCSRyZXN1bHQgPSB0cn?UmVtb3ZlX215X3N1aXRlZF90ZXh0X2Zvcl9MUEdfUExVR0lOUw==?VlOw0KCQl9IGVsc2Ugew0KCQkJJHJlc3VsdCA9IGZhbHNlOw0KCQl9DQoJCQ0KPz4=